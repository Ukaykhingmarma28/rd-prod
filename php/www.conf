[www]
user  = www-data
group = www-data

listen = 0.0.0.0:9000

; ── Process manager ─────────────────────────────────────────────
; dynamic: spawn workers as needed, free them when idle
pm                      = dynamic

; Max simultaneous PHP requests (tune: RAM_for_PHP / ~50MB per worker)
; 2048MB / 50MB ≈ 40 workers max
pm.max_children         = 40

; Workers kept alive at all times
pm.start_servers        = 10

; Min idle workers waiting for requests
pm.min_spare_servers    = 5

; Max idle workers (kill extras above this)
pm.max_spare_servers    = 20

; Recycle workers after this many requests (prevents memory leaks)
pm.max_requests         = 500

; ── Slow log ────────────────────────────────────────────────────
slowlog                 = /var/log/php-fpm-slow.log
request_slowlog_timeout = 5s

; ── Status page (useful for monitoring) ─────────────────────────
pm.status_path = /status
ping.path      = /ping